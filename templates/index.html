{% extends "base.html" %}
{% block content %}
<section class="panel">
  <div class="panel-left">
    <h1>Evidence Eye: Password Catcher</h1>
    <p class="subtitle">Catch only <strong>strong</strong> passwords. If you catch a <strong>weak</strong> password, the game ends.</p>

    <div class="hud">
      <div>Score: <span id="score">0</span></div>
      <div>Time: <span id="time">60</span>s</div>
      <div>Misses: <span id="misses">0</span> / 5</div>
    </div>

    <canvas id="gameCanvas" width="720" height="480" aria-label="Password Catcher Game"></canvas>

    <div class="controls">
      <p><strong>Controls:</strong> Move basket with <kbd>←</kbd> <kbd>→</kbd> or mouse. Catch strong passwords. Avoid weak ones.</p>
      <button id="startBtn">Start</button>
      <button id="restartBtn" class="secondary" disabled>Restart</button>
    </div>
  </div>

  <aside class="panel-right">
    <div class="card">
      <h3>Hint / Expert Tips</h3>
      <ul>
        <li>Strong passwords mix <em>upper/lowercase</em>, <em>numbers</em>, and <em>symbols</em>.</li>
        <li>Avoid common phrases, keyboard patterns, or personal info.</li>
        <li>Use at least 12 characters; longer is stronger.</li>
      </ul>
    </div>
    <div class="card">
      <h3>What Counts as Strong?</h3>
      <p>Looks random, hard to guess, not reused. Example: <code>J@ck_2025!</code></p>
    </div>
    <div class="card">
      <h3>After-Action Review</h3>
      <p>At the end, you’ll see what you caught, with quick feedback on mistakes.</p>
    </div>
  </aside>
</section>

<!-- Game Over Modal -->
<div id="overlay" class="overlay hidden">
  <div class="modal">
    <h2 id="modalTitle">Game Over</h2>
    <p id="modalReason"></p>
    <div class="review">
      <h3>Review of Catches</h3>
      <table id="reviewTable">
        <thead>
          <tr><th>#</th><th>Password</th><th>Verdict</th><th>Tip</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="modal-actions">
      <button id="closeModal">Close</button>
      <button id="playAgain" class="secondary">Play Again</button>
    </div>
  </div>
</div>

<script>
  // Inject password data via Jinja -> window.gameData
  window.gameData = {
    strong: {{ strong_passwords|tojson }},
    weak: {{ weak_passwords|tojson }}
  };
</script>
<script src="{{ url_for('static', filename='game.js') }}"></script>
{% endblock %}
